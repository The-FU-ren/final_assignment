flowchart TD
    A[开始] --> B{选择运行模式}
    
    subgraph 运行模式选择
        B -->|实时捕获数据包| C[初始化网络接口]
        B -->|从文件读取数据包| D[选择PCAP文件]
    end
    
    subgraph 数据包处理流程
        C --> E[捕获网络数据包]
        D --> F[读取PCAP文件]
        E --> G[识别数据包协议]
        F --> G
        G --> H[解码数据包内容]
    end
    
    subgraph 结果处理
        H --> I{结果处理方式}
        I -->|实时显示| J[在界面显示数据包]
        I -->|保存到文件| K[保存为PCAP文件]
        I -->|统计分析| L[生成协议统计]
    end
    
    subgraph 用户交互
        J --> M{用户操作}
        M -->|选择数据包| N[查看数据包详情]
        M -->|设置过滤规则| O[过滤显示数据包]
        M -->|停止捕获| P[结束捕获]
        N --> Q[显示详细解码信息]
        O --> J
        P --> R[结束程序]
    end
    
    K --> R
    L --> R
    Q --> M
    
    R[结束程序] --> S[退出]
