flowchart TD
    A[初始化PacketCapture对象] --> B[获取网络接口列表]
    B --> C[选择目标网络接口]
    C --> D[配置捕获参数<br>过滤规则、捕获数量、超时时间]
    D --> E[调用Scapy的sniff函数]
    E --> F[从数据链路层捕获原始数据包]
    F --> G[应用BPF过滤规则]
    G --> H[存储符合条件的数据包]
    H --> I{是否达到捕获条件?<br>数量/超时}
    I -->|是| J[返回捕获的数据包]
    I -->|否| F
    J --> K[结束捕获]
