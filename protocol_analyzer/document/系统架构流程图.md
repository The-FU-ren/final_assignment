```mermaid
flowchart TD
    subgraph 应用层
        A[命令行界面(main)]
        B[图形界面(qt_gui)]
    end

    subgraph 业务逻辑层
        C[数据包捕获模块<br/>(packet_capture)]
        D[协议识别模块<br/>(protocol_identifier)]
        E[协议解码模块<br/>(protocol_decoder)]
        F[数据存储模块<br/>(packet_storage)]
    end

    subgraph 底层依赖层
        G[Scapy库]
        H[PyQt5库]
        I[标准库]
        J[其他依赖库]
    end

    A -->|依赖| C
    A -->|依赖| D
    A -->|依赖| E
    A -->|依赖| F
    B -->|依赖| C
    B -->|依赖| D
    B -->|依赖| E
    B -->|依赖| F
    
    C -->|依赖| G
    C -->|依赖| I
    C -->|依赖| J
    D -->|依赖| I
    D -->|依赖| J
    E -->|依赖| I
    E -->|依赖| J
    F -->|依赖| I
    F -->|依赖| J
    B -->|依赖| H
```