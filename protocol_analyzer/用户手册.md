# 网络协议分析软件用户手册

## 1. 软件概述

### 1.1 软件简介
网络协议分析软件是一款功能强大的网络数据包捕获和分析工具，支持实时数据包捕获、协议识别、数据包解码、统计分析等功能。软件提供命令行和图形界面两种交互方式，适合网络管理员、安全分析师、开发人员等各类用户使用。

### 1.2 主要功能
- 实时网络数据包捕获
- 支持BPF过滤规则
- 自动协议识别（TCP、UDP、HTTP、DNS、ICMP等）
- 详细的数据包解码
- 协议统计与可视化
- PCAP文件导入/导出
- 支持浅色/深色主题切换
- 友好的图形用户界面
- 灵活的命令行接口

### 1.3 应用场景
- 网络故障排查
- 网络性能分析
- 安全威胁检测
- 协议开发与调试
- 网络流量监控
- 教学与研究

## 2. 系统要求

### 2.1 硬件要求
- CPU: 双核处理器或更高
- 内存: 2GB RAM或更高
- 硬盘: 100MB可用空间
- 网络接口: 至少一个可用的网络接口

### 2.2 软件要求
- 操作系统: Windows 7/8/10/11, macOS, Linux
- Python版本: Python 3.8或更高
- 依赖库: Scapy, PyQt5, pyqtgraph等（详见requirements.txt）

## 3. 安装方法

### 3.1 从源代码安装

#### 3.1.1 下载源代码
1. 从版本控制系统或官方网站下载软件源代码
2. 解压源代码到本地目录

#### 3.1.2 安装依赖库
```bash
# 进入软件目录
cd protocol_analyzer

# 安装依赖库
pip install -r requirements.txt
```

#### 3.1.3 验证安装
```bash
# 运行命令行界面，查看帮助信息
python main.py --help

# 运行图形界面
python qt_gui.py
```

### 3.2 常见安装问题

| 问题 | 解决方法 |
|------|----------|
| 缺少权限 | 在命令前添加sudo（Linux/macOS）或使用管理员权限运行（Windows） |
| Scapy安装失败 | 尝试使用管理员权限安装，或参考Scapy官方安装文档 |
| PyQt5安装失败 | 确保Python版本符合要求，或使用国内镜像源安装 |
| 依赖库版本冲突 | 创建虚拟环境并重新安装依赖 |

## 4. 使用方法

### 4.1 命令行界面使用

#### 4.1.1 基本语法
```bash
python main.py [选项] [参数]
```

#### 4.1.2 主要选项
| 选项 | 说明 | 示例 |
|------|------|------|
| `-i, --interface` | 指定网络接口 | `-i "Ethernet 2"` |
| `-c, --count` | 捕获数据包数量 | `-c 100` |
| `-f, --filter` | BPF过滤规则 | `-f "tcp port 80"` |
| `-o, --output` | 输出PCAP文件路径 | `-o capture.pcap` |
| `-r, --read` | 读取PCAP文件进行分析 | `-r capture.pcap` |
| `--help` | 显示帮助信息 | `--help` |

#### 4.1.3 使用示例

##### 示例1：列出可用网络接口
```bash
python main.py
```

##### 示例2：捕获指定数量的数据包
```bash
python main.py -i "Ethernet 2" -c 100
```

##### 示例3：使用BPF过滤规则捕获TCP数据包
```bash
python main.py -i "Ethernet 2" -c 50 -f "tcp port 80"
```

##### 示例4：捕获并保存数据包到PCAP文件
```bash
python main.py -i "Ethernet 2" -c 100 -o capture.pcap
```

##### 示例5：分析已有的PCAP文件
```bash
python main.py -r capture.pcap
```

### 4.2 图形界面使用

#### 4.2.1 启动图形界面
```bash
python qt_gui.py
```

#### 4.2.2 主界面介绍

图形界面主要包括以下几个部分：

1. **菜单栏**：包含文件、捕获、分析、视图、帮助等菜单
2. **工具栏**：提供常用操作的快捷按钮
3. **控制面板**：用于配置捕获参数
4. **数据包列表**：显示捕获的数据包摘要信息
5. **数据包详情**：显示选中数据包的详细解码信息
6. **统计视图**：显示协议分布统计信息
7. **接口状态**：显示网络接口状态信息

#### 4.2.3 基本操作流程

##### 步骤1：选择网络接口
1. 在控制面板中，从"网络接口"下拉菜单中选择一个可用的网络接口
2. 如果接口列表为空，点击"刷新接口"按钮

##### 步骤2：配置捕获参数
1. 设置"捕获数量"（可选，默认为100）
2. 输入BPF过滤规则（可选）
3. 选择是否保存到PCAP文件（可选）

##### 步骤3：开始捕获
1. 点击"开始捕获"按钮
2. 查看数据包列表中的实时捕获结果

##### 步骤4：查看数据包详情
1. 在数据包列表中点击任意数据包
2. 在下方"数据包详情"区域查看详细的解码信息

##### 步骤5：查看统计信息
1. 切换到"统计视图"标签页
2. 查看协议分布统计图表

##### 步骤6：停止捕获
1. 点击"停止捕获"按钮
2. 捕获过程结束，可继续分析已捕获的数据包

#### 4.2.4 高级功能

##### PCAP文件导入/导出
- **导入PCAP文件**：
  1. 点击菜单栏"文件" → "打开PCAP文件"
  2. 选择要导入的PCAP文件
  3. 查看导入的数据包

- **导出PCAP文件**：
  1. 捕获数据包或导入PCAP文件
  2. 点击菜单栏"文件" → "保存PCAP文件"
  3. 选择保存路径和文件名

##### 主题切换
1. 点击菜单栏"视图" → "切换主题"
2. 软件将在浅色主题和深色主题之间切换

##### 数据包过滤
1. 在数据包列表上方的搜索框中输入过滤条件
2. 按回车键或点击搜索按钮
3. 数据包列表将只显示符合条件的数据包

## 5. 功能特点

### 5.1 实时捕获功能
- 支持从多个网络接口同时捕获
- 可配置捕获数量和超时时间
- 实时显示捕获的数据包
- 支持后台捕获模式

### 5.2 协议识别功能
- 自动识别多种网络协议
- 支持分层协议识别（数据链路层到应用层）
- 高准确率的应用层协议识别
- 可扩展的协议识别框架

### 5.3 数据包解码功能
- 详细的协议字段解码
- 支持嵌套协议解码
- 格式化的解码输出
- 支持原始数据查看

### 5.4 统计分析功能
- 实时协议统计
- 可视化的统计图表
- 支持导出统计报告
- 协议分布分析
- 流量趋势分析

### 5.5 用户界面功能
- 直观的图形界面
- 支持拖拽操作
- 可定制的界面布局
- 支持快捷键操作
- 友好的错误提示

## 6. 协议支持

### 6.1 支持的协议列表

| 协议层级 | 支持的协议 |
|----------|------------|
| 数据链路层 | Ethernet |
| 网络层 | IP, IPv6, ARP, ICMP |
| 传输层 | TCP, UDP |
| 应用层 | HTTP, DNS, DHCP, FTP, SMTP, POP3, IMAP, SSH, TLS/SSL |

### 6.2 协议识别特征

| 协议 | 识别特征 |
|------|----------|
| HTTP | TCP端口80或443，数据载荷包含HTTP方法或状态码 |
| DNS | UDP或TCP端口53，数据载荷符合DNS报文格式 |
| DHCP | UDP端口67或68，数据载荷符合DHCP报文格式 |
| FTP | TCP端口21，数据载荷包含FTP命令或响应 |
| SMTP | TCP端口25，数据载荷包含SMTP命令或响应 |
| SSH | TCP端口22，数据载荷符合SSH协议格式 |

## 7. 常见问题与解决方法

### 7.1 捕获相关问题

| 问题 | 解决方法 |
|------|----------|
| 无法找到网络接口 | 以管理员身份运行软件，或检查网络接口是否正常工作 |
| 捕获到的数据包为0 | 检查过滤规则是否正确，或网络接口是否有流量 |
| 捕获过程中程序崩溃 | 减少捕获数量，或优化系统资源使用 |
| 权限不足导致捕获失败 | 使用管理员权限运行软件，或添加用户到相应组（Linux/macOS） |

### 7.2 分析相关问题

| 问题 | 解决方法 |
|------|----------|
| 协议识别错误 | 检查协议实现是否正确，或更新软件版本 |
| 数据包解码不完整 | 确保数据包包含完整的协议栈，或检查协议实现 |
| 统计信息不准确 | 确保捕获的数据包数量足够，或检查统计算法 |

### 7.3 界面相关问题

| 问题 | 解决方法 |
|------|----------|
| 界面响应缓慢 | 减少捕获的数据包数量，或优化系统资源使用 |
| 主题显示异常 | 检查PyQt5版本是否兼容，或重置主题设置 |
| 布局混乱 | 调整界面大小，或重置布局设置 |

### 7.4 其他问题

| 问题 | 解决方法 |
|------|----------|
| 软件无法启动 | 检查Python版本和依赖库是否符合要求 |
| PCAP文件无法打开 | 检查文件格式是否正确，或文件是否损坏 |
| 内存占用过高 | 减少捕获的数据包数量，或优化代码 |

## 8. 技术支持与反馈

### 8.1 联系方式
- 官方网站：[协议分析软件官方网站]
- 邮箱：[support@protocol-analyzer.example.com]
- 论坛：[协议分析软件社区论坛]
- GitHub：[GitHub仓库地址]

### 8.2 反馈建议
- 欢迎提交Bug报告和功能建议
- 提供详细的问题描述和重现步骤
- 附上相关的日志文件和截图
- 说明软件版本和操作系统信息

### 8.3 更新日志

#### v1.0.0（2025-12-30）
- 初始版本发布
- 支持实时数据包捕获
- 支持协议识别和解码
- 提供命令行和图形界面
- 支持PCAP文件导入/导出
- 支持浅色/深色主题

## 9. 许可证信息

网络协议分析软件采用MIT许可证，允许自由使用、修改和分发。详细许可证信息请查看LICENSE文件。

## 10. 免责声明

1. 本软件仅供合法用途使用，请勿用于非法活动
2. 使用本软件捕获和分析网络流量时，请遵守相关法律法规
3. 本软件不保证100%的协议识别准确率
4. 本软件不承担因使用不当造成的任何损失
5. 请在使用前仔细阅读并理解本免责声明

## 11. 附录

### 11.1 BPF过滤规则示例

| 过滤规则 | 说明 |
|----------|------|
| `tcp` | 仅捕获TCP数据包 |
| `udp` | 仅捕获UDP数据包 |
| `icmp` | 仅捕获ICMP数据包 |
| `tcp port 80` | 仅捕获TCP端口80的数据包（HTTP） |
| `udp port 53` | 仅捕获UDP端口53的数据包（DNS） |
| `host 192.168.1.1` | 仅捕获与192.168.1.1相关的数据包 |
| `src host 192.168.1.1` | 仅捕获源地址为192.168.1.1的数据包 |
| `dst host 192.168.1.1` | 仅捕获目标地址为192.168.1.1的数据包 |
| `net 192.168.1.0/24` | 仅捕获192.168.1.0/24网段的数据包 |
| `tcp and port 80 and host 192.168.1.1` | 仅捕获与192.168.1.1相关的TCP端口80数据包 |

### 11.2 快捷键列表

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+O` | 打开PCAP文件 |
| `Ctrl+S` | 保存PCAP文件 |
| `Ctrl+R` | 开始/停止捕获 |
| `Ctrl+T` | 切换主题 |
| `Ctrl+F` | 查找数据包 |
| `Ctrl+L` | 清除数据包列表 |
| `Ctrl+Q` | 退出软件 |
| `F5` | 刷新网络接口列表 |
| `F1` | 打开帮助文档 |

### 11.3 术语表

| 术语 | 解释 |
|------|------|
| BPF | Berkeley Packet Filter，伯克利数据包过滤器 |
| PCAP | Packet Capture，数据包捕获文件格式 |
| Scapy | 一个强大的Python网络数据包处理库 |
| PyQt5 | Python的Qt5绑定库，用于开发图形界面 |
| DNS | Domain Name System，域名系统 |
| HTTP | Hypertext Transfer Protocol，超文本传输协议 |
| TCP | Transmission Control Protocol，传输控制协议 |
| UDP | User Datagram Protocol，用户数据报协议 |
| IP | Internet Protocol，互联网协议 |
| ARP | Address Resolution Protocol，地址解析协议 |
| ICMP | Internet Control Message Protocol，互联网控制消息协议 |

---

感谢您使用网络协议分析软件！希望本用户手册能帮助您快速掌握软件的使用。如有任何问题或建议，欢迎随时联系我们。

祝您使用愉快！

网络协议分析软件开发团队
2025年12月30日